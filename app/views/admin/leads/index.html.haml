
%script{:type => "text/javascript"}
  function checkAll(cb)
  {

  var val = cb.checked;
  var frm = document.delete;
  var len = frm.elements.length;
  var i=0;
  for( i=0 ; i<len ; i++) 
  {
  frm.elements[i].checked=val;
  }
  }
  function selectedaction(type)
  {

  document.getElementById('result').value = type;
  document.delete.submit();
  }


  jQuery(document).ready( function() {
  setTimeout(function(){ jQuery("#message").fadeOut(); }, 5000);  
  });
 
  jQuery(document).ready(function () {

  //select all the a tag with name equal to modal
  jQuery('a[name=modal]').click(function (e) {

  //Cancel the link behavior
  e.preventDefault();

  //Get the A tag
  var id = jQuery(this).attr('href');

  //Get the screen height and width
  var maskHeight = jQuery(document).height();
  var maskWidth = jQuery(window).width();

  //Set heigth and width to mask to fill up the whole screen
  jQuery('#mask').css({
  'width': maskWidth,
  'height': maskHeight
  });

  //transition effect		
  jQuery('#mask').fadeIn(1000);
  jQuery('#mask').fadeTo("slow", 0.8);

  //Get the window height and width
  var winH = jQuery(window).height();
  var winW = jQuery(window).width();

  //Set the popup window to center
  jQuery(id).css('top', winH / 2 - jQuery(id).height() / 2);
  jQuery(id).css('left', winW / 2 - jQuery(id).width() / 2);

  //transition effect
  jQuery(id).fadeIn(2000);

  });


  jQuery('a[name=modal1]').click(function (e) {

  //Cancel the link behavior
  e.preventDefault();

  //Get the A tag
  var id = jQuery(this).attr('href');

  //Get the screen height and width
  var maskHeight = jQuery(document).height();
  var maskWidth = jQuery(window).width();

  //Set heigth and width to mask to fill up the whole screen
  jQuery('#mask').css({
  'width': maskWidth,
  'height': maskHeight
  });

  //transition effect		
  jQuery('#mask').fadeIn(1000);
  jQuery('#mask').fadeTo("slow", 0.8);

  //Get the window height and width
  var winH = jQuery(window).height();
  var winW = jQuery(window).width();

  //Set the popup window to center
  jQuery(id).css('top', winH / 2 - jQuery(id).height() / 2);
  jQuery(id).css('left', winW / 2 - jQuery(id).width() / 2);

  //transition effect
  jQuery(id).fadeIn(2000);

  });


  //if close button is clicked
  jQuery('.window .close').click(function (e) {
  //Cancel the link behavior
  e.preventDefault();

  jQuery('#mask').fadeOut(200);
  jQuery('.window').fadeOut(200);
  });

  //if mask is clicked
  jQuery('#mask').click(function () {
  jQuery(this).hide();
  jQuery('.window').fadeOut(200);
  });

  });


/ content wrapper
#contentwrapper
  #contentcolumn
    .innertube-1
      - if flash[:notice]
        .success_message{:id => 'message'}
          %span
          = flash[:notice]
      / head block wrapper
      .head_block_wrapper
        / heading
        .heading_inner_blocks
          %h2 Leads
        / heading end
        / approval block
        .approved-block
          %ul
            %li
              - if params[:list].blank? && params[:industry_search].blank?
                = "All (#{@all_leads})"
              - else
                =link_to "All (#{@all_leads})", admin_leads_path
            %li
              - if params[:list] == 'appointed'
                = "Appointed (#{@appointed_count})"
              - else
                =link_to "Appointed (#{@appointed_count})",admin_leads_path(:list => 'appointed') 
		

          / approval block end
        %br.clear_all/
      / filter option block
      #filter_option_wrapper
      = form_for(:search, :url => admin_leads_path(:industry_search => params[:industry_search], :turnover_search => params[:turnover_search] ),:html => {:name => "appl_form",:method => :get, :onSubmit => "return leadssearch();"}) do
        %table{:border => "0", :cellpadding => "0", :cellspacing => "0", :width => "100%"}
          %tr
            %td.filter{:rowspan => "2", :width => "77px"} Filter by :
            %td.top_vbtm Industry
            %td.top_vbtm Country
            %td.top_vbtm Score
            %td.top_vbtm Turnover
	    
          %tr
            %td
              = select_tag "industry_search", options_for_select(Gigavine::Preferences.industries,params[:industry_search] ),{:include_blank => 'Select Industry',:onchange => "this.form.submit();"}
            %td
              - if params[:lead]
                = select( "lead","country",country_options_for_select(:country,[params[:lead][:country]]),{},{:style  => "width:130px;",:onchange => "this.form.submit();"})
              - else
                = select( "lead","country",country_options_for_select(:country),{:include_blank => 'Select Country'},{:style  => "width:130px;",:onchange => "this.form.submit();"})
            %td
              %select
                %option Select Score
            %td
              = select_tag "turnover_search", options_for_select(Gigavine::Preferences.turnovers,params[:turnover_search]),{:include_blank => 'Select Turnover',:onchange => "this.form.submit();"}

      / filter option block end
      / user action wrapper block
      .spacer.clear_all
        %span
      - form_for(:search, :url => delete_all_admin_leads_path,:html => {:method => :get,:name => 'delete'}) do  
        .user_action_block
          .add_view
            = hidden_field_tag 'result'
            %ul
              %li
                -#%a{:href => "#", :title=> "Click here to add new lead"} Add New
                = link_to "Add New", new_admin_lead_path
              %li
                - if params[:action] == 'index' && params[:industry_search].blank? && params[:turnover_search].blank?
                  %a{:href => "#"}  View
                - else
                  = link_to "View", admin_leads_path		
              %li
                = link_to "Modify", '#',:onclick => "selectedaction('modify');",:title=> "Click here to modify leads"
              %li                
                = link_to "Appoint", '#',:onclick => "selectedaction('appoint');", :title=> "Click here to appoint leads"

              %li
                = link_to "Delete", '#',:onclick => "selectedaction('delete');", :title=> "Click here to delete leads"
        / user action 2 block
      %span
        .bulk_action_block
          %table{:border => "0", :cellpadding => "0", :cellspacing => "0", :width => "100%"}
            %tr
              %td{:valign => "top"}
                %select.select_box_strech
                  %option Bulk Action 1
                  %option Bulk Action 1
              %td
                %input.apply-bg{:type => "button", :value => "Apply"}/

              

              #boxes
              %td
                %a{:href => "#dialog", :name => "modal"}  
                  %input.import-bg{:type => "button", :value => "Import"}/
                #dialog.window
                  .inner_block_modal
                    %h3 Import Leads
                    - form_for(:impcsv, :url =>{:action=>'csv_import'}, :html => { :multipart => true,:onsubmit=>"return Checkfiles();" }) do |f|
                      %p
                        = f.file_field :csv_file_upload, :label=>"Import", :size=>"10"
                        = f.submit 'Upload'
                    %a.close{:href => "#"}
                      %span
		
		
        / user action 2 block end
        .spacer.clear_all
          %span
        .spacer.clear_all
          %span 
        / table grid block
        .grid_wrapper
          %table.myTable01{:cellpadding => "0", :cellspacing => "0"}
            %thead
              %tr
                %th
                  %input{:type => "checkbox", :onClick => "checkAll(this);"}/
                %th.sort_list
                  - if params[:sort] == 'company_d'
                    %a.sort_desc_anchor{:href => "leads?sort=company_a"} Company
                  - else
                    %a.sort_asc_anchor{:href => "leads?sort=company_d"} Company
                %th.sort_list
                  - if params[:sort] == 'fname_d'
                    %a.sort_desc_anchor{:href => "leads?sort=fname_a"}  Main Contact
                  - else
                    %a.sort_asc_anchor{:href => "leads?sort=fname_d"}  Main Contact
                %th.sort_list
                  - if params[:sort] == 'status_d'
                    %a.sort_desc_anchor{:href => "leads?sort=status_a"}  Status
                  - else
                    %a.sort_asc_anchor{:href => "leads?sort=status_d"}  Status

                %th.sort_list
                  - if params[:sort] == 'email_d'
                    %a.sort_desc_anchor{:href => "leads?sort=email_a"}  Email
                  - else
                    %a.sort_asc_anchor{:href => "leads?sort=email_d"}  Email
                %th.sort_list
                  - if params[:sort] == 'country_d'
                    %a.sort_desc_anchor{:href => "leads?sort=country_a"}  Country
                  - else
                    %a.sort_asc_anchor{:href => "leads?sort=country_d"}  Country
                %th.sort_list
                  - if params[:sort] == 'industry_d'
                    %a.sort_desc_anchor{:href => "leads?sort=industry_a"} Industry
                  - else
                    %a.sort_asc_anchor{:href => "leads?sort=industry_d"} Industry
                %th
                  - if params[:sort] == 'web_d'
                    %a.sort_desc_anchor{:href => "leads?sort=web_a"} Website
                  - else
                    %a.sort_asc_anchor{:href => "leads?sort=web_d"} Website
                %th.sort_list 
                  - if params[:sort] == 'appoint_d'
                    %a.sort_desc_anchor{:href => "leads?sort=appoint_a"} Appointed to
                  - else
                    %a.sort_asc_anchor{:href => "leads?sort=appoint_d"} Appointed to
                %th Lead score
            %tbody
              - if !@leads.blank?
                - @leads.each_with_index do |lead,j| 
                  %tr
                    %td
                      = check_box_tag "lead[]", lead.id 
                    %td 
                      = lead.company
                    %td 
                      = link_to "#{lead.first_name}", edit_admin_lead_path(lead)
                    %td 
                      = lead.status
                    %td 
                      = lead.email
                    %td 
                      = lead.country
                    %td 
                      = lead.industry
                    %td 
                      = lead.web_url
                    %td
                      - if lead.appointed_to		  
                        = lead.appointed_to
                      - else
                        = '-None-'
                    %td Cold
              - else
                %tr
                  %td{:colspan => 7}
                    = "No Leads found for your search."

            / table grid block end
    .clear_all
  / content wrapper end
= render :partial => "leftmenu"
#mask
    

